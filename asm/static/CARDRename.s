.include "macros.inc"

.section .text

.org 0x800928E0

.global CARDRenameAsync
CARDRenameAsync:
/* 800928E0 0008F840  7C 08 02 A6 */	mflr r0
/* 800928E4 0008F844  90 01 00 04 */	stw r0, 4(r1)
/* 800928E8 0008F848  94 21 FF B8 */	stwu r1, -0x48(r1)
/* 800928EC 0008F84C  BE E1 00 24 */	stmw r23, 0x24(r1)
/* 800928F0 0008F850  7C 9D 23 78 */	mr r29, r4
/* 800928F4 0008F854  3B 83 00 00 */	addi r28, r3, 0
/* 800928F8 0008F858  3B C5 00 00 */	addi r30, r5, 0
/* 800928FC 0008F85C  3B E6 00 00 */	addi r31, r6, 0
/* 80092900 0008F860  88 84 00 00 */	lbz r4, 0(r4)
/* 80092904 0008F864  7C 80 07 74 */	extsb r0, r4
/* 80092908 0008F868  2C 00 00 FF */	cmpwi r0, 0xff
/* 8009290C 0008F86C  41 82 00 24 */	beq lbl_80092930
/* 80092910 0008F870  88 7E 00 00 */	lbz r3, 0(r30)
/* 80092914 0008F874  7C 60 07 74 */	extsb r0, r3
/* 80092918 0008F878  2C 00 00 FF */	cmpwi r0, 0xff
/* 8009291C 0008F87C  41 82 00 14 */	beq lbl_80092930
/* 80092920 0008F880  7C 80 07 75 */	extsb. r0, r4
/* 80092924 0008F884  41 82 00 0C */	beq lbl_80092930
/* 80092928 0008F888  7C 60 07 75 */	extsb. r0, r3
/* 8009292C 0008F88C  40 82 00 0C */	bne lbl_80092938
lbl_80092930:
/* 80092930 0008F890  38 60 FF 80 */	li r3, -128
/* 80092934 0008F894  48 00 01 94 */	b lbl_80092AC8
lbl_80092938:
/* 80092938 0008F898  7F A3 EB 78 */	mr r3, r29
/* 8009293C 0008F89C  48 00 CF 11 */	bl strlen
/* 80092940 0008F8A0  28 03 00 20 */	cmplwi r3, 0x20
/* 80092944 0008F8A4  41 81 00 14 */	bgt lbl_80092958
/* 80092948 0008F8A8  7F C3 F3 78 */	mr r3, r30
/* 8009294C 0008F8AC  48 00 CF 01 */	bl strlen
/* 80092950 0008F8B0  28 03 00 20 */	cmplwi r3, 0x20
/* 80092954 0008F8B4  40 81 00 0C */	ble lbl_80092960
lbl_80092958:
/* 80092958 0008F8B8  38 60 FF F4 */	li r3, -12
/* 8009295C 0008F8BC  48 00 01 6C */	b lbl_80092AC8
lbl_80092960:
/* 80092960 0008F8C0  38 7C 00 00 */	addi r3, r28, 0
/* 80092964 0008F8C4  38 81 00 18 */	addi r4, r1, 0x18
/* 80092968 0008F8C8  4B FF B7 E5 */	bl __CARDGetControlBlock
/* 8009296C 0008F8CC  2C 03 00 00 */	cmpwi r3, 0
/* 80092970 0008F8D0  40 80 00 08 */	bge lbl_80092978
/* 80092974 0008F8D4  48 00 01 54 */	b lbl_80092AC8
lbl_80092978:
/* 80092978 0008F8D8  80 61 00 18 */	lwz r3, 0x18(r1)
/* 8009297C 0008F8DC  3A E0 FF FF */	li r23, -1
/* 80092980 0008F8E0  3B 00 FF FF */	li r24, -1
/* 80092984 0008F8E4  4B FF C2 55 */	bl __CARDGetDirBlock
/* 80092988 0008F8E8  3B 43 00 00 */	addi r26, r3, 0
/* 8009298C 0008F8EC  3B 7A 00 00 */	addi r27, r26, 0
/* 80092990 0008F8F0  3B 20 00 00 */	li r25, 0
lbl_80092994:
/* 80092994 0008F8F4  88 1B 00 00 */	lbz r0, 0(r27)
/* 80092998 0008F8F8  28 00 00 FF */	cmplwi r0, 0xff
/* 8009299C 0008F8FC  41 82 00 70 */	beq lbl_80092A0C
/* 800929A0 0008F900  80 81 00 18 */	lwz r4, 0x18(r1)
/* 800929A4 0008F904  38 7B 00 00 */	addi r3, r27, 0
/* 800929A8 0008F908  38 A0 00 04 */	li r5, 4
/* 800929AC 0008F90C  80 84 01 0C */	lwz r4, 0x10c(r4)
/* 800929B0 0008F910  48 00 A6 45 */	bl memcmp
/* 800929B4 0008F914  2C 03 00 00 */	cmpwi r3, 0
/* 800929B8 0008F918  40 82 00 54 */	bne lbl_80092A0C
/* 800929BC 0008F91C  80 81 00 18 */	lwz r4, 0x18(r1)
/* 800929C0 0008F920  38 7B 00 04 */	addi r3, r27, 4
/* 800929C4 0008F924  38 A0 00 02 */	li r5, 2
/* 800929C8 0008F928  80 84 01 0C */	lwz r4, 0x10c(r4)
/* 800929CC 0008F92C  38 84 00 04 */	addi r4, r4, 4
/* 800929D0 0008F930  48 00 A6 25 */	bl memcmp
/* 800929D4 0008F934  2C 03 00 00 */	cmpwi r3, 0
/* 800929D8 0008F938  40 82 00 34 */	bne lbl_80092A0C
/* 800929DC 0008F93C  38 7B 00 00 */	addi r3, r27, 0
/* 800929E0 0008F940  38 9D 00 00 */	addi r4, r29, 0
/* 800929E4 0008F944  4B FF E6 E1 */	bl __CARDCompareFileName
/* 800929E8 0008F948  2C 03 00 00 */	cmpwi r3, 0
/* 800929EC 0008F94C  41 82 00 08 */	beq lbl_800929F4
/* 800929F0 0008F950  7F 37 CB 78 */	mr r23, r25
lbl_800929F4:
/* 800929F4 0008F954  38 7B 00 00 */	addi r3, r27, 0
/* 800929F8 0008F958  38 9E 00 00 */	addi r4, r30, 0
/* 800929FC 0008F95C  4B FF E6 C9 */	bl __CARDCompareFileName
/* 80092A00 0008F960  2C 03 00 00 */	cmpwi r3, 0
/* 80092A04 0008F964  41 82 00 08 */	beq lbl_80092A0C
/* 80092A08 0008F968  7F 38 CB 78 */	mr r24, r25
lbl_80092A0C:
/* 80092A0C 0008F96C  3B 39 00 01 */	addi r25, r25, 1
/* 80092A10 0008F970  2C 19 00 7F */	cmpwi r25, 0x7f
/* 80092A14 0008F974  3B 7B 00 40 */	addi r27, r27, 0x40
/* 80092A18 0008F978  41 80 FF 7C */	blt lbl_80092994
/* 80092A1C 0008F97C  2C 17 FF FF */	cmpwi r23, -1
/* 80092A20 0008F980  40 82 00 14 */	bne lbl_80092A34
/* 80092A24 0008F984  80 61 00 18 */	lwz r3, 0x18(r1)
/* 80092A28 0008F988  38 80 FF FC */	li r4, -4
/* 80092A2C 0008F98C  4B FF B7 D9 */	bl __CARDPutControlBlock
/* 80092A30 0008F990  48 00 00 98 */	b lbl_80092AC8
lbl_80092A34:
/* 80092A34 0008F994  2C 18 FF FF */	cmpwi r24, -1
/* 80092A38 0008F998  41 82 00 14 */	beq lbl_80092A4C
/* 80092A3C 0008F99C  80 61 00 18 */	lwz r3, 0x18(r1)
/* 80092A40 0008F9A0  38 80 FF F9 */	li r4, -7
/* 80092A44 0008F9A4  4B FF B7 C1 */	bl __CARDPutControlBlock
/* 80092A48 0008F9A8  48 00 00 80 */	b lbl_80092AC8
lbl_80092A4C:
/* 80092A4C 0008F9AC  56 E0 30 32 */	slwi r0, r23, 6
/* 80092A50 0008F9B0  80 61 00 18 */	lwz r3, 0x18(r1)
/* 80092A54 0008F9B4  7F 7A 02 14 */	add r27, r26, r0
/* 80092A58 0008F9B8  38 9B 00 00 */	addi r4, r27, 0
/* 80092A5C 0008F9BC  4B FF E6 D1 */	bl __CARDAccess
/* 80092A60 0008F9C0  7C 64 1B 79 */	or. r4, r3, r3
/* 80092A64 0008F9C4  40 80 00 10 */	bge lbl_80092A74
/* 80092A68 0008F9C8  80 61 00 18 */	lwz r3, 0x18(r1)
/* 80092A6C 0008F9CC  4B FF B7 99 */	bl __CARDPutControlBlock
/* 80092A70 0008F9D0  48 00 00 58 */	b lbl_80092AC8
lbl_80092A74:
/* 80092A74 0008F9D4  38 9E 00 00 */	addi r4, r30, 0
/* 80092A78 0008F9D8  38 7B 00 08 */	addi r3, r27, 8
/* 80092A7C 0008F9DC  38 A0 00 20 */	li r5, 0x20
/* 80092A80 0008F9E0  48 00 CC D1 */	bl strncpy
/* 80092A84 0008F9E4  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 80092A88 0008F9E8  80 03 00 F8 */	lwz r0, 0x800000F8@l(r3)
/* 80092A8C 0008F9EC  54 1D F0 BE */	srwi r29, r0, 2
/* 80092A90 0008F9F0  4B FE CC 69 */	bl OSGetTime
/* 80092A94 0008F9F4  38 DD 00 00 */	addi r6, r29, 0
/* 80092A98 0008F9F8  38 A0 00 00 */	li r5, 0
/* 80092A9C 0008F9FC  48 00 85 81 */	bl __div2i
/* 80092AA0 0008FA00  90 9B 00 28 */	stw r4, 0x28(r27)
/* 80092AA4 0008FA04  38 7C 00 00 */	addi r3, r28, 0
/* 80092AA8 0008FA08  38 9F 00 00 */	addi r4, r31, 0
/* 80092AAC 0008FA0C  4B FF C2 CD */	bl __CARDUpdateDir
/* 80092AB0 0008FA10  7C 7B 1B 79 */	or. r27, r3, r3
/* 80092AB4 0008FA14  40 80 00 10 */	bge lbl_80092AC4
/* 80092AB8 0008FA18  80 61 00 18 */	lwz r3, 0x18(r1)
/* 80092ABC 0008FA1C  7F 64 DB 78 */	mr r4, r27
/* 80092AC0 0008FA20  4B FF B7 45 */	bl __CARDPutControlBlock
lbl_80092AC4:
/* 80092AC4 0008FA24  7F 63 DB 78 */	mr r3, r27
lbl_80092AC8:
/* 80092AC8 0008FA28  BA E1 00 24 */	lmw r23, 0x24(r1)
/* 80092ACC 0008FA2C  80 01 00 4C */	lwz r0, 0x4c(r1)
/* 80092AD0 0008FA30  38 21 00 48 */	addi r1, r1, 0x48
/* 80092AD4 0008FA34  7C 08 03 A6 */	mtlr r0
/* 80092AD8 0008FA38  4E 80 00 20 */	blr 

.global CARDRename
CARDRename:
/* 80092ADC 0008FA3C  7C 08 02 A6 */	mflr r0
/* 80092AE0 0008FA40  3C C0 80 09 */	lis r6, __CARDSyncCallback@ha
/* 80092AE4 0008FA44  90 01 00 04 */	stw r0, 4(r1)
/* 80092AE8 0008FA48  38 C6 D2 08 */	addi r6, r6, __CARDSyncCallback@l
/* 80092AEC 0008FA4C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80092AF0 0008FA50  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80092AF4 0008FA54  3B E3 00 00 */	addi r31, r3, 0
/* 80092AF8 0008FA58  4B FF FD E9 */	bl CARDRenameAsync
/* 80092AFC 0008FA5C  2C 03 00 00 */	cmpwi r3, 0
/* 80092B00 0008FA60  40 80 00 08 */	bge lbl_80092B08
/* 80092B04 0008FA64  48 00 00 0C */	b lbl_80092B10
lbl_80092B08:
/* 80092B08 0008FA68  7F E3 FB 78 */	mr r3, r31
/* 80092B0C 0008FA6C  4B FF B9 61 */	bl __CARDSync
lbl_80092B10:
/* 80092B10 0008FA70  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80092B14 0008FA74  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80092B18 0008FA78  38 21 00 20 */	addi r1, r1, 0x20
/* 80092B1C 0008FA7C  7C 08 03 A6 */	mtlr r0
/* 80092B20 0008FA80  4E 80 00 20 */	blr 
