.include "macros.inc"

.section .text

.org 0x80048130

.global GBAGetProcessStatus
GBAGetProcessStatus:
/* 80048130 00045090  7C 08 02 A6 */	mflr r0
/* 80048134 00045094  3C A0 80 1F */	lis r5, __GBA@ha
/* 80048138 00045098  90 01 00 04 */	stw r0, 4(r1)
/* 8004813C 0004509C  54 63 40 2E */	slwi r3, r3, 8
/* 80048140 000450A0  38 05 6D 80 */	addi r0, r5, __GBA@l
/* 80048144 000450A4  94 21 FF C8 */	stwu r1, -0x38(r1)
/* 80048148 000450A8  BE E1 00 14 */	stmw r23, 0x14(r1)
/* 8004814C 000450AC  7E E0 1A 14 */	add r23, r0, r3
/* 80048150 000450B0  3B 04 00 00 */	addi r24, r4, 0
/* 80048154 000450B4  3B F7 00 40 */	addi r31, r23, 0x40
/* 80048158 000450B8  48 03 2A CD */	bl OSDisableInterrupts
/* 8004815C 000450BC  80 1F 00 14 */	lwz r0, 0x14(r31)
/* 80048160 000450C0  3B A3 00 00 */	addi r29, r3, 0
/* 80048164 000450C4  28 00 00 00 */	cmplwi r0, 0
/* 80048168 000450C8  41 82 01 04 */	beq lbl_8004826C
/* 8004816C 000450CC  80 7F 00 34 */	lwz r3, 0x34(r31)
/* 80048170 000450D0  3B C0 00 00 */	li r30, 0
/* 80048174 000450D4  80 1F 00 28 */	lwz r0, 0x28(r31)
/* 80048178 000450D8  3B 80 00 02 */	li r28, 2
/* 8004817C 000450DC  1C A3 00 64 */	mulli r5, r3, 0x64
/* 80048180 000450E0  80 9F 00 64 */	lwz r4, 0x64(r31)
/* 80048184 000450E4  80 7F 00 2C */	lwz r3, 0x2c(r31)
/* 80048188 000450E8  7C 85 23 D6 */	divw r4, r5, r4
/* 8004818C 000450EC  7C 63 F2 78 */	xor r3, r3, r30
/* 80048190 000450F0  7C 00 F2 78 */	xor r0, r0, r30
/* 80048194 000450F4  7C 60 03 79 */	or. r0, r3, r0
/* 80048198 000450F8  54 9B 06 3E */	clrlwi r27, r4, 0x18
/* 8004819C 000450FC  41 82 00 C0 */	beq lbl_8004825C
/* 800481A0 00045100  48 03 75 59 */	bl OSGetTime
/* 800481A4 00045104  3E E0 80 00 */	lis r23, 0x800000F8@ha
/* 800481A8 00045108  80 DF 00 2C */	lwz r6, 0x2c(r31)
/* 800481AC 0004510C  80 17 00 F8 */	lwz r0, 0x800000F8@l(r23)
/* 800481B0 00045110  3C A0 10 62 */	lis r5, 0x10624DD3@ha
/* 800481B4 00045114  7F 26 20 10 */	subfc r25, r6, r4
/* 800481B8 00045118  80 9F 00 28 */	lwz r4, 0x28(r31)
/* 800481BC 0004511C  3B E5 4D D3 */	addi r31, r5, 0x10624DD3@l
/* 800481C0 00045120  54 00 F0 BE */	srwi r0, r0, 2
/* 800481C4 00045124  7C 1F 00 16 */	mulhwu r0, r31, r0
/* 800481C8 00045128  7F 44 19 10 */	subfe r26, r4, r3
/* 800481CC 0004512C  54 06 D1 BE */	srwi r6, r0, 6
/* 800481D0 00045130  38 7A 00 00 */	addi r3, r26, 0
/* 800481D4 00045134  38 99 00 00 */	addi r4, r25, 0
/* 800481D8 00045138  38 A0 00 00 */	li r5, 0
/* 800481DC 0004513C  48 05 2E 41 */	bl __div2i
/* 800481E0 00045140  38 E0 15 7C */	li r7, 0x157c
/* 800481E4 00045144  6C 65 80 00 */	xoris r5, r3, 0x8000
/* 800481E8 00045148  6F C3 80 00 */	xoris r3, r30, 0x8000
/* 800481EC 0004514C  7C 07 20 10 */	subfc r0, r7, r4
/* 800481F0 00045150  7C 63 29 10 */	subfe r3, r3, r5
/* 800481F4 00045154  7C 65 29 10 */	subfe r3, r5, r5
/* 800481F8 00045158  7C 63 00 D1 */	neg. r3, r3
/* 800481FC 0004515C  41 82 00 50 */	beq lbl_8004824C
/* 80048200 00045160  80 77 00 F8 */	lwz r3, 0xf8(r23)
/* 80048204 00045164  7C BE 39 D6 */	mullw r5, r30, r7
/* 80048208 00045168  54 63 F0 BE */	srwi r3, r3, 2
/* 8004820C 0004516C  7C 7F 18 16 */	mulhwu r3, r31, r3
/* 80048210 00045170  54 66 D1 BE */	srwi r6, r3, 6
/* 80048214 00045174  7C 66 38 16 */	mulhwu r3, r6, r7
/* 80048218 00045178  7C A5 1A 14 */	add r5, r5, r3
/* 8004821C 0004517C  7C 66 F1 D6 */	mullw r3, r6, r30
/* 80048220 00045180  7F 60 FE 70 */	srawi r0, r27, 0x1f
/* 80048224 00045184  7C A5 1A 14 */	add r5, r5, r3
/* 80048228 00045188  7C 60 C9 D6 */	mullw r3, r0, r25
/* 8004822C 0004518C  7C 1B C8 16 */	mulhwu r0, r27, r25
/* 80048230 00045190  7C 63 02 14 */	add r3, r3, r0
/* 80048234 00045194  7C 1B D1 D6 */	mullw r0, r27, r26
/* 80048238 00045198  7C 9B C9 D6 */	mullw r4, r27, r25
/* 8004823C 0004519C  7C C6 39 D6 */	mullw r6, r6, r7
/* 80048240 000451A0  7C 63 02 14 */	add r3, r3, r0
/* 80048244 000451A4  48 05 2D D9 */	bl __div2i
/* 80048248 000451A8  7C 9B 23 78 */	mr r27, r4
lbl_8004824C:
/* 8004824C 000451AC  57 60 06 3E */	clrlwi r0, r27, 0x18
/* 80048250 000451B0  28 00 00 64 */	cmplwi r0, 0x64
/* 80048254 000451B4  41 80 00 08 */	blt lbl_8004825C
/* 80048258 000451B8  3B 60 00 64 */	li r27, 0x64
lbl_8004825C:
/* 8004825C 000451BC  28 18 00 00 */	cmplwi r24, 0
/* 80048260 000451C0  41 82 00 24 */	beq lbl_80048284
/* 80048264 000451C4  9B 78 00 00 */	stb r27, 0(r24)
/* 80048268 000451C8  48 00 00 1C */	b lbl_80048284
lbl_8004826C:
/* 8004826C 000451CC  80 17 00 1C */	lwz r0, 0x1c(r23)
/* 80048270 000451D0  28 00 00 00 */	cmplwi r0, 0
/* 80048274 000451D4  41 82 00 0C */	beq lbl_80048280
/* 80048278 000451D8  3B 80 00 02 */	li r28, 2
/* 8004827C 000451DC  48 00 00 08 */	b lbl_80048284
lbl_80048280:
/* 80048280 000451E0  3B 80 00 00 */	li r28, 0
lbl_80048284:
/* 80048284 000451E4  7F A3 EB 78 */	mr r3, r29
/* 80048288 000451E8  48 03 29 C5 */	bl OSRestoreInterrupts
/* 8004828C 000451EC  7F 83 E3 78 */	mr r3, r28
/* 80048290 000451F0  BA E1 00 14 */	lmw r23, 0x14(r1)
/* 80048294 000451F4  80 01 00 3C */	lwz r0, 0x3c(r1)
/* 80048298 000451F8  38 21 00 38 */	addi r1, r1, 0x38
/* 8004829C 000451FC  7C 08 03 A6 */	mtlr r0
/* 800482A0 00045200  4E 80 00 20 */	blr 
