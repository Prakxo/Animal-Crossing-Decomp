.include "macros.inc"

.section .text

.org 0x8007A9B0

.global OSSetErrorHandler
OSSetErrorHandler:
/* 8007A9B0 00077910  3C A0 80 20 */	lis r5, __OSErrorTable@ha
/* 8007A9B4 00077914  54 63 13 BA */	rlwinm r3, r3, 2, 0xe, 0x1d
/* 8007A9B8 00077918  38 05 73 90 */	addi r0, r5, __OSErrorTable@l
/* 8007A9BC 0007791C  7C A0 1A 14 */	add r5, r0, r3
/* 8007A9C0 00077920  80 65 00 00 */	lwz r3, 0(r5)
/* 8007A9C4 00077924  90 85 00 00 */	stw r4, 0(r5)
/* 8007A9C8 00077928  4E 80 00 20 */	blr 

.global __OSUnhandledException
__OSUnhandledException:
/* 8007A9CC 0007792C  7C 08 02 A6 */	mflr r0
/* 8007A9D0 00077930  90 01 00 04 */	stw r0, 4(r1)
/* 8007A9D4 00077934  94 21 FF C8 */	stwu r1, -0x38(r1)
/* 8007A9D8 00077938  BF 21 00 1C */	stmw r25, 0x1c(r1)
/* 8007A9DC 0007793C  7C 9F 23 78 */	mr r31, r4
/* 8007A9E0 00077940  3B 23 00 00 */	addi r25, r3, 0
/* 8007A9E4 00077944  3B 45 00 00 */	addi r26, r5, 0
/* 8007A9E8 00077948  3B 66 00 00 */	addi r27, r6, 0
/* 8007A9EC 0007794C  80 04 01 9C */	lwz r0, 0x19c(r4)
/* 8007A9F0 00077950  3C 80 80 0E */	lis r4, @10@ha
/* 8007A9F4 00077954  3B A4 FE 08 */	addi r29, r4, @10@l
/* 8007A9F8 00077958  54 00 07 BD */	rlwinm. r0, r0, 0, 0x1e, 0x1e
/* 8007A9FC 0007795C  40 82 00 18 */	bne lbl_8007AA14
/* 8007AA00 00077960  38 7D 00 5C */	addi r3, r29, 0x5c
/* 8007AA04 00077964  4C C6 31 82 */	crclr 6
/* 8007AA08 00077968  57 24 06 3E */	clrlwi r4, r25, 0x18
/* 8007AA0C 0007796C  4B FD FD 45 */	bl OSReport
/* 8007AA10 00077970  48 00 00 7C */	b lbl_8007AA8C
lbl_8007AA14:
/* 8007AA14 00077974  57 3E 06 3E */	clrlwi r30, r25, 0x18
/* 8007AA18 00077978  3C 60 80 20 */	lis r3, __OSErrorTable@ha
/* 8007AA1C 0007797C  57 24 15 BA */	rlwinm r4, r25, 2, 0x16, 0x1d
/* 8007AA20 00077980  38 03 73 90 */	addi r0, r3, __OSErrorTable@l
/* 8007AA24 00077984  7F 80 22 14 */	add r28, r0, r4
/* 8007AA28 00077988  80 1C 00 00 */	lwz r0, 0(r28)
/* 8007AA2C 0007798C  28 00 00 00 */	cmplwi r0, 0
/* 8007AA30 00077990  41 82 00 38 */	beq lbl_8007AA68
/* 8007AA34 00077994  48 00 32 E9 */	bl OSDisableScheduler
/* 8007AA38 00077998  81 9C 00 00 */	lwz r12, 0(r28)
/* 8007AA3C 0007799C  38 7E 00 00 */	addi r3, r30, 0
/* 8007AA40 000779A0  38 9F 00 00 */	addi r4, r31, 0
/* 8007AA44 000779A4  4C C6 31 82 */	crclr 6
/* 8007AA48 000779A8  7D 88 03 A6 */	mtlr r12
/* 8007AA4C 000779AC  38 BA 00 00 */	addi r5, r26, 0
/* 8007AA50 000779B0  38 DB 00 00 */	addi r6, r27, 0
/* 8007AA54 000779B4  4E 80 00 21 */	blrl 
/* 8007AA58 000779B8  48 00 33 05 */	bl OSEnableScheduler
/* 8007AA5C 000779BC  48 00 37 F5 */	bl __OSReschedule
/* 8007AA60 000779C0  7F E3 FB 78 */	mr r3, r31
/* 8007AA64 000779C4  4B FF F8 ED */	bl OSLoadContext
lbl_8007AA68:
/* 8007AA68 000779C8  57 20 06 3E */	clrlwi r0, r25, 0x18
/* 8007AA6C 000779CC  28 00 00 08 */	cmplwi r0, 8
/* 8007AA70 000779D0  40 82 00 0C */	bne lbl_8007AA7C
/* 8007AA74 000779D4  7F E3 FB 78 */	mr r3, r31
/* 8007AA78 000779D8  4B FF F8 D9 */	bl OSLoadContext
lbl_8007AA7C:
/* 8007AA7C 000779DC  38 7D 00 7C */	addi r3, r29, 0x7c
/* 8007AA80 000779E0  4C C6 31 82 */	crclr 6
/* 8007AA84 000779E4  57 24 06 3E */	clrlwi r4, r25, 0x18
/* 8007AA88 000779E8  4B FD FC C9 */	bl OSReport
lbl_8007AA8C:
/* 8007AA8C 000779EC  38 6D 86 00 */	addi r3, r13, @32-_SDA_BASE_
/* 8007AA90 000779F0  4C C6 31 82 */	crclr 6
/* 8007AA94 000779F4  4B FD FC BD */	bl OSReport
/* 8007AA98 000779F8  7F E3 FB 78 */	mr r3, r31
/* 8007AA9C 000779FC  4B FF FA 75 */	bl OSDumpContext
/* 8007AAA0 00077A00  38 9A 00 00 */	addi r4, r26, 0
/* 8007AAA4 00077A04  4C C6 31 82 */	crclr 6
/* 8007AAA8 00077A08  38 BB 00 00 */	addi r5, r27, 0
/* 8007AAAC 00077A0C  38 7D 00 94 */	addi r3, r29, 0x94
/* 8007AAB0 00077A10  4B FD FC A1 */	bl OSReport
/* 8007AAB4 00077A14  48 00 4C 45 */	bl OSGetTime
/* 8007AAB8 00077A18  38 A3 00 00 */	addi r5, r3, 0
/* 8007AABC 00077A1C  4C C6 31 82 */	crclr 6
/* 8007AAC0 00077A20  38 C4 00 00 */	addi r6, r4, 0
/* 8007AAC4 00077A24  38 7D 00 C8 */	addi r3, r29, 0xc8
/* 8007AAC8 00077A28  4B FD FC 89 */	bl OSReport
/* 8007AACC 00077A2C  57 20 06 3E */	clrlwi r0, r25, 0x18
/* 8007AAD0 00077A30  28 00 00 0F */	cmplwi r0, 0xf
/* 8007AAD4 00077A34  41 81 00 C4 */	bgt lbl_8007AB98
/* 8007AAD8 00077A38  3C 60 80 0E */	lis r3, @43@ha
/* 8007AADC 00077A3C  38 63 00 E4 */	addi r3, r3, @43@l
/* 8007AAE0 00077A40  54 00 10 3A */	slwi r0, r0, 2
/* 8007AAE4 00077A44  7C 03 00 2E */	lwzx r0, r3, r0
/* 8007AAE8 00077A48  7C 09 03 A6 */	mtctr r0
/* 8007AAEC 00077A4C  4E 80 04 20 */	bctr 
/* 8007AAF0 00077A50  80 9F 01 98 */	lwz r4, 0x198(r31)
/* 8007AAF4 00077A54  38 BB 00 00 */	addi r5, r27, 0
/* 8007AAF8 00077A58  38 7D 00 D8 */	addi r3, r29, 0xd8
/* 8007AAFC 00077A5C  4C C6 31 82 */	crclr 6
/* 8007AB00 00077A60  4B FD FC 51 */	bl OSReport
/* 8007AB04 00077A64  48 00 00 94 */	b lbl_8007AB98
/* 8007AB08 00077A68  80 9F 01 98 */	lwz r4, 0x198(r31)
/* 8007AB0C 00077A6C  38 7D 01 38 */	addi r3, r29, 0x138
/* 8007AB10 00077A70  4C C6 31 82 */	crclr 6
/* 8007AB14 00077A74  4B FD FC 3D */	bl OSReport
/* 8007AB18 00077A78  48 00 00 80 */	b lbl_8007AB98
/* 8007AB1C 00077A7C  80 9F 01 98 */	lwz r4, 0x198(r31)
/* 8007AB20 00077A80  38 BB 00 00 */	addi r5, r27, 0
/* 8007AB24 00077A84  38 7D 01 84 */	addi r3, r29, 0x184
/* 8007AB28 00077A88  4C C6 31 82 */	crclr 6
/* 8007AB2C 00077A8C  4B FD FC 25 */	bl OSReport
/* 8007AB30 00077A90  48 00 00 68 */	b lbl_8007AB98
/* 8007AB34 00077A94  80 9F 01 98 */	lwz r4, 0x198(r31)
/* 8007AB38 00077A98  38 BB 00 00 */	addi r5, r27, 0
/* 8007AB3C 00077A9C  38 7D 01 E8 */	addi r3, r29, 0x1e8
/* 8007AB40 00077AA0  4C C6 31 82 */	crclr 6
/* 8007AB44 00077AA4  4B FD FC 0D */	bl OSReport
/* 8007AB48 00077AA8  48 00 00 50 */	b lbl_8007AB98
/* 8007AB4C 00077AAC  38 6D 86 00 */	addi r3, r13, @32-_SDA_BASE_
/* 8007AB50 00077AB0  4C C6 31 82 */	crclr 6
/* 8007AB54 00077AB4  4B FD FB FD */	bl OSReport
/* 8007AB58 00077AB8  3F C0 CC 00 */	lis r30, 0xCC005000@ha
/* 8007AB5C 00077ABC  4C C6 31 82 */	crclr 6
/* 8007AB60 00077AC0  3B FE 50 00 */	addi r31, r30, 0xCC005000@l
/* 8007AB64 00077AC4  A0 9E 50 30 */	lhz r4, 0x5030(r30)
/* 8007AB68 00077AC8  38 7D 02 48 */	addi r3, r29, 0x248
/* 8007AB6C 00077ACC  A0 BE 50 32 */	lhz r5, 0x5032(r30)
/* 8007AB70 00077AD0  4B FD FB E1 */	bl OSReport
/* 8007AB74 00077AD4  A0 9F 00 20 */	lhz r4, 0x20(r31)
/* 8007AB78 00077AD8  38 7D 02 68 */	addi r3, r29, 0x268
/* 8007AB7C 00077ADC  A0 BF 00 22 */	lhz r5, 0x22(r31)
/* 8007AB80 00077AE0  4C C6 31 82 */	crclr 6
/* 8007AB84 00077AE4  4B FD FB CD */	bl OSReport
/* 8007AB88 00077AE8  80 9E 60 14 */	lwz r4, 0x6014(r30)
/* 8007AB8C 00077AEC  4C C6 31 82 */	crclr 6
/* 8007AB90 00077AF0  38 7D 02 88 */	addi r3, r29, 0x288
/* 8007AB94 00077AF4  4B FD FB BD */	bl OSReport
lbl_8007AB98:
/* 8007AB98 00077AF8  A8 8D 8D 88 */	lha r4, __OSLastInterrupt-_SDA_BASE_(r13)
/* 8007AB9C 00077AFC  38 7D 02 A4 */	addi r3, r29, 0x2a4
/* 8007ABA0 00077B00  4C C6 31 82 */	crclr 6
/* 8007ABA4 00077B04  80 AD 8D 84 */	lwz r5, __OSLastInterruptSrr0-_SDA_BASE_(r13)
/* 8007ABA8 00077B08  80 ED 8D 90 */	lwz r7, __OSLastInterruptTime-_SDA_BASE_(r13)
/* 8007ABAC 00077B0C  81 0D 8D 94 */	lwz r8, lbl_80218914-_SDA_BASE_(r13)
/* 8007ABB0 00077B10  4B FD FB A1 */	bl OSReport
/* 8007ABB4 00077B14  4B FF DB 09 */	bl PPCHalt
/* 8007ABB8 00077B18  BB 21 00 1C */	lmw r25, 0x1c(r1)
/* 8007ABBC 00077B1C  80 01 00 3C */	lwz r0, 0x3c(r1)
/* 8007ABC0 00077B20  38 21 00 38 */	addi r1, r1, 0x38
/* 8007ABC4 00077B24  7C 08 03 A6 */	mtlr r0
/* 8007ABC8 00077B28  4E 80 00 20 */	blr 
