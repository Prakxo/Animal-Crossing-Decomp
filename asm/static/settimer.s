.include "macros.inc"

.section .text

.org 0x80060198

.global timer_handler
timer_handler:
/* 80060198 0005D0F8  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8006019C 0005D0FC  7C 08 02 A6 */	mflr r0
/* 800601A0 0005D100  90 01 00 24 */	stw r0, 0x24(r1)
/* 800601A4 0005D104  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800601A8 0005D108  90 61 00 08 */	stw r3, 8(r1)
/* 800601AC 0005D10C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800601B0 0005D110  83 E1 00 08 */	lwz r31, 8(r1)
/* 800601B4 0005D114  48 01 AA 71 */	bl OSDisableInterrupts
/* 800601B8 0005D118  80 BF 00 30 */	lwz r5, 0x30(r31)
/* 800601BC 0005D11C  38 00 00 00 */	li r0, 0
/* 800601C0 0005D120  80 DF 00 34 */	lwz r6, 0x34(r31)
/* 800601C4 0005D124  38 80 00 00 */	li r4, 0
/* 800601C8 0005D128  7C A0 02 78 */	xor r0, r5, r0
/* 800601CC 0005D12C  7C 7E 1B 78 */	mr r30, r3
/* 800601D0 0005D130  7C C4 22 78 */	xor r4, r6, r4
/* 800601D4 0005D134  7C 80 03 79 */	or. r0, r4, r0
/* 800601D8 0005D138  41 82 00 20 */	beq lbl_800601F8
/* 800601DC 0005D13C  3C 60 80 06 */	lis r3, timer_handler@ha
/* 800601E0 0005D140  80 BF 00 30 */	lwz r5, 0x30(r31)
/* 800601E4 0005D144  38 E3 01 98 */	addi r7, r3, timer_handler@l
/* 800601E8 0005D148  80 DF 00 34 */	lwz r6, 0x34(r31)
/* 800601EC 0005D14C  7F E3 FB 78 */	mr r3, r31
/* 800601F0 0005D150  48 01 91 2D */	bl OSSetAlarm
/* 800601F4 0005D154  48 00 00 34 */	b lbl_80060228
lbl_800601F8:
/* 800601F8 0005D158  80 DF 00 28 */	lwz r6, 0x28(r31)
/* 800601FC 0005D15C  38 60 00 00 */	li r3, 0
/* 80060200 0005D160  80 BF 00 2C */	lwz r5, 0x2c(r31)
/* 80060204 0005D164  38 00 00 00 */	li r0, 0
/* 80060208 0005D168  80 9F 00 28 */	lwz r4, 0x28(r31)
/* 8006020C 0005D16C  90 C1 00 0C */	stw r6, 0xc(r1)
/* 80060210 0005D170  90 A4 00 2C */	stw r5, 0x2c(r4)
/* 80060214 0005D174  80 BF 00 28 */	lwz r5, 0x28(r31)
/* 80060218 0005D178  80 9F 00 2C */	lwz r4, 0x2c(r31)
/* 8006021C 0005D17C  90 A4 00 28 */	stw r5, 0x28(r4)
/* 80060220 0005D180  90 7F 00 28 */	stw r3, 0x28(r31)
/* 80060224 0005D184  90 1F 00 2C */	stw r0, 0x2c(r31)
lbl_80060228:
/* 80060228 0005D188  80 7F 00 40 */	lwz r3, 0x40(r31)
/* 8006022C 0005D18C  38 A0 00 00 */	li r5, 0
/* 80060230 0005D190  80 9F 00 44 */	lwz r4, 0x44(r31)
/* 80060234 0005D194  4B FF FF 09 */	bl osSendMesg
/* 80060238 0005D198  7F C3 F3 78 */	mr r3, r30
/* 8006023C 0005D19C  48 01 AA 11 */	bl OSRestoreInterrupts
/* 80060240 0005D1A0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80060244 0005D1A4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80060248 0005D1A8  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8006024C 0005D1AC  7C 08 03 A6 */	mtlr r0
/* 80060250 0005D1B0  38 21 00 20 */	addi r1, r1, 0x20
/* 80060254 0005D1B4  4E 80 00 20 */	blr 

.global osSetTimer
osSetTimer:
/* 80060258 0005D1B8  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 8006025C 0005D1BC  7C 08 02 A6 */	mflr r0
/* 80060260 0005D1C0  90 01 00 34 */	stw r0, 0x34(r1)
/* 80060264 0005D1C4  39 61 00 30 */	addi r11, r1, 0x30
/* 80060268 0005D1C8  48 03 AC 5D */	bl func_8009AEC4
/* 8006026C 0005D1CC  91 21 00 08 */	stw r9, 8(r1)
/* 80060270 0005D1D0  7C 7F 1B 78 */	mr r31, r3
/* 80060274 0005D1D4  7C BC 2B 78 */	mr r28, r5
/* 80060278 0005D1D8  7C DD 33 78 */	mr r29, r6
/* 8006027C 0005D1DC  91 41 00 0C */	stw r10, 0xc(r1)
/* 80060280 0005D1E0  7C F9 3B 78 */	mr r25, r7
/* 80060284 0005D1E4  7D 1A 43 78 */	mr r26, r8
/* 80060288 0005D1E8  48 01 A9 9D */	bl OSDisableInterrupts
/* 8006028C 0005D1EC  38 80 00 00 */	li r4, 0
/* 80060290 0005D1F0  38 00 00 00 */	li r0, 0
/* 80060294 0005D1F4  7F A4 22 78 */	xor r4, r29, r4
/* 80060298 0005D1F8  7C 7B 1B 78 */	mr r27, r3
/* 8006029C 0005D1FC  7F 80 02 78 */	xor r0, r28, r0
/* 800602A0 0005D200  7C 80 03 79 */	or. r0, r4, r0
/* 800602A4 0005D204  40 82 00 0C */	bne lbl_800602B0
/* 800602A8 0005D208  7F 5D D3 78 */	mr r29, r26
/* 800602AC 0005D20C  7F 3C CB 78 */	mr r28, r25
lbl_800602B0:
/* 800602B0 0005D210  7F E3 FB 78 */	mr r3, r31
/* 800602B4 0005D214  48 01 8E 0D */	bl OSCreateAlarm
/* 800602B8 0005D218  80 A1 00 08 */	lwz r5, 8(r1)
/* 800602BC 0005D21C  38 60 00 00 */	li r3, 0
/* 800602C0 0005D220  38 00 00 00 */	li r0, 0
/* 800602C4 0005D224  80 81 00 0C */	lwz r4, 0xc(r1)
/* 800602C8 0005D228  90 BF 00 40 */	stw r5, 0x40(r31)
/* 800602CC 0005D22C  7F A3 1A 78 */	xor r3, r29, r3
/* 800602D0 0005D230  7F 80 02 78 */	xor r0, r28, r0
/* 800602D4 0005D234  90 9F 00 44 */	stw r4, 0x44(r31)
/* 800602D8 0005D238  7C 60 03 79 */	or. r0, r3, r0
/* 800602DC 0005D23C  93 5F 00 34 */	stw r26, 0x34(r31)
/* 800602E0 0005D240  93 3F 00 30 */	stw r25, 0x30(r31)
/* 800602E4 0005D244  93 BF 00 3C */	stw r29, 0x3c(r31)
/* 800602E8 0005D248  93 9F 00 38 */	stw r28, 0x38(r31)
/* 800602EC 0005D24C  80 6D 82 98 */	lwz r3, __osTimerList-_SDA_BASE_(r13)
/* 800602F0 0005D250  83 C3 00 28 */	lwz r30, 0x28(r3)
/* 800602F4 0005D254  93 DF 00 28 */	stw r30, 0x28(r31)
/* 800602F8 0005D258  80 1E 00 2C */	lwz r0, 0x2c(r30)
/* 800602FC 0005D25C  90 1F 00 2C */	stw r0, 0x2c(r31)
/* 80060300 0005D260  80 7E 00 2C */	lwz r3, 0x2c(r30)
/* 80060304 0005D264  93 E3 00 28 */	stw r31, 0x28(r3)
/* 80060308 0005D268  93 FE 00 2C */	stw r31, 0x2c(r30)
/* 8006030C 0005D26C  41 82 00 1C */	beq lbl_80060328
/* 80060310 0005D270  3C 80 80 06 */	lis r4, timer_handler@ha
/* 80060314 0005D274  7F E3 FB 78 */	mr r3, r31
/* 80060318 0005D278  38 E4 01 98 */	addi r7, r4, timer_handler@l
/* 8006031C 0005D27C  7F A6 EB 78 */	mr r6, r29
/* 80060320 0005D280  7F 85 E3 78 */	mr r5, r28
/* 80060324 0005D284  48 01 8F F9 */	bl OSSetAlarm
lbl_80060328:
/* 80060328 0005D288  7F 63 DB 78 */	mr r3, r27
/* 8006032C 0005D28C  48 01 A9 21 */	bl OSRestoreInterrupts
/* 80060330 0005D290  38 60 00 00 */	li r3, 0
/* 80060334 0005D294  39 61 00 30 */	addi r11, r1, 0x30
/* 80060338 0005D298  48 03 AB D9 */	bl func_8009AF10
/* 8006033C 0005D29C  80 01 00 34 */	lwz r0, 0x34(r1)
/* 80060340 0005D2A0  7C 08 03 A6 */	mtlr r0
/* 80060344 0005D2A4  38 21 00 30 */	addi r1, r1, 0x30
/* 80060348 0005D2A8  4E 80 00 20 */	blr 
