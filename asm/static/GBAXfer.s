.include "macros.inc"

.section .text

.org 0x80049450

.global __GBAHandler
__GBAHandler:
/* 80049450 000463B0  7C 08 02 A6 */	mflr r0
/* 80049454 000463B4  90 01 00 04 */	stw r0, 4(r1)
/* 80049458 000463B8  94 21 FD 08 */	stwu r1, -0x2f8(r1)
/* 8004945C 000463BC  93 E1 02 F4 */	stw r31, 0x2f4(r1)
/* 80049460 000463C0  93 C1 02 F0 */	stw r30, 0x2f0(r1)
/* 80049464 000463C4  3B C5 00 00 */	addi r30, r5, 0
/* 80049468 000463C8  93 A1 02 EC */	stw r29, 0x2ec(r1)
/* 8004946C 000463CC  3B A3 00 00 */	addi r29, r3, 0
/* 80049470 000463D0  3C 60 80 1F */	lis r3, __GBA@ha
/* 80049474 000463D4  80 0D 8A 30 */	lwz r0, __GBAReset-_SDA_BASE_(r13)
/* 80049478 000463D8  57 A6 40 2E */	slwi r6, r29, 8
/* 8004947C 000463DC  2C 00 00 00 */	cmpwi r0, 0
/* 80049480 000463E0  38 03 6D 80 */	addi r0, r3, __GBA@l
/* 80049484 000463E4  7F E0 32 14 */	add r31, r0, r6
/* 80049488 000463E8  40 82 00 88 */	bne lbl_80049510
/* 8004948C 000463EC  54 80 07 3F */	clrlwi. r0, r4, 0x1c
/* 80049490 000463F0  41 82 00 10 */	beq lbl_800494A0
/* 80049494 000463F4  38 00 00 01 */	li r0, 1
/* 80049498 000463F8  90 1F 00 20 */	stw r0, 0x20(r31)
/* 8004949C 000463FC  48 00 00 0C */	b lbl_800494A8
lbl_800494A0:
/* 800494A0 00046400  38 00 00 00 */	li r0, 0
/* 800494A4 00046404  90 1F 00 20 */	stw r0, 0x20(r31)
lbl_800494A8:
/* 800494A8 00046408  81 9F 00 38 */	lwz r12, 0x38(r31)
/* 800494AC 0004640C  28 0C 00 00 */	cmplwi r12, 0
/* 800494B0 00046410  41 82 00 18 */	beq lbl_800494C8
/* 800494B4 00046414  38 00 00 00 */	li r0, 0
/* 800494B8 00046418  7D 88 03 A6 */	mtlr r12
/* 800494BC 0004641C  90 1F 00 38 */	stw r0, 0x38(r31)
/* 800494C0 00046420  7F A3 EB 78 */	mr r3, r29
/* 800494C4 00046424  4E 80 00 21 */	blrl 
lbl_800494C8:
/* 800494C8 00046428  80 1F 00 1C */	lwz r0, 0x1c(r31)
/* 800494CC 0004642C  28 00 00 00 */	cmplwi r0, 0
/* 800494D0 00046430  41 82 00 40 */	beq lbl_80049510
/* 800494D4 00046434  38 61 00 18 */	addi r3, r1, 0x18
/* 800494D8 00046438  48 03 0F 59 */	bl OSClearContext
/* 800494DC 0004643C  38 61 00 18 */	addi r3, r1, 0x18
/* 800494E0 00046440  48 03 0D 89 */	bl OSSetCurrentContext
/* 800494E4 00046444  81 9F 00 1C */	lwz r12, 0x1c(r31)
/* 800494E8 00046448  38 00 00 00 */	li r0, 0
/* 800494EC 0004644C  38 7D 00 00 */	addi r3, r29, 0
/* 800494F0 00046450  90 1F 00 1C */	stw r0, 0x1c(r31)
/* 800494F4 00046454  7D 88 03 A6 */	mtlr r12
/* 800494F8 00046458  80 9F 00 20 */	lwz r4, 0x20(r31)
/* 800494FC 0004645C  4E 80 00 21 */	blrl 
/* 80049500 00046460  38 61 00 18 */	addi r3, r1, 0x18
/* 80049504 00046464  48 03 0F 2D */	bl OSClearContext
/* 80049508 00046468  7F C3 F3 78 */	mr r3, r30
/* 8004950C 0004646C  48 03 0D 5D */	bl OSSetCurrentContext
lbl_80049510:
/* 80049510 00046470  80 01 02 FC */	lwz r0, 0x2fc(r1)
/* 80049514 00046474  83 E1 02 F4 */	lwz r31, 0x2f4(r1)
/* 80049518 00046478  83 C1 02 F0 */	lwz r30, 0x2f0(r1)
/* 8004951C 0004647C  83 A1 02 EC */	lwz r29, 0x2ec(r1)
/* 80049520 00046480  38 21 02 F8 */	addi r1, r1, 0x2f8
/* 80049524 00046484  7C 08 03 A6 */	mtlr r0
/* 80049528 00046488  4E 80 00 20 */	blr 

.global __GBASyncCallback
__GBASyncCallback:
/* 8004952C 0004648C  7C 08 02 A6 */	mflr r0
/* 80049530 00046490  3C 80 80 1F */	lis r4, __GBA@ha
/* 80049534 00046494  90 01 00 04 */	stw r0, 4(r1)
/* 80049538 00046498  54 63 40 2E */	slwi r3, r3, 8
/* 8004953C 0004649C  38 04 6D 80 */	addi r0, r4, __GBA@l
/* 80049540 000464A0  7C 60 1A 14 */	add r3, r0, r3
/* 80049544 000464A4  94 21 FF F8 */	stwu r1, -8(r1)
/* 80049548 000464A8  38 63 00 24 */	addi r3, r3, 0x24
/* 8004954C 000464AC  48 03 57 F5 */	bl OSWakeupThread
/* 80049550 000464B0  80 01 00 0C */	lwz r0, 0xc(r1)
/* 80049554 000464B4  38 21 00 08 */	addi r1, r1, 8
/* 80049558 000464B8  7C 08 03 A6 */	mtlr r0
/* 8004955C 000464BC  4E 80 00 20 */	blr 

.global __GBASync
__GBASync:
/* 80049560 000464C0  7C 08 02 A6 */	mflr r0
/* 80049564 000464C4  3C 80 80 1F */	lis r4, __GBA@ha
/* 80049568 000464C8  90 01 00 04 */	stw r0, 4(r1)
/* 8004956C 000464CC  54 63 40 2E */	slwi r3, r3, 8
/* 80049570 000464D0  38 04 6D 80 */	addi r0, r4, __GBA@l
/* 80049574 000464D4  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 80049578 000464D8  93 E1 00 14 */	stw r31, 0x14(r1)
/* 8004957C 000464DC  7F E0 1A 14 */	add r31, r0, r3
/* 80049580 000464E0  93 C1 00 10 */	stw r30, 0x10(r1)
/* 80049584 000464E4  48 03 16 A1 */	bl OSDisableInterrupts
/* 80049588 000464E8  7C 7E 1B 78 */	mr r30, r3
/* 8004958C 000464EC  48 00 00 0C */	b lbl_80049598
lbl_80049590:
/* 80049590 000464F0  38 7F 00 24 */	addi r3, r31, 0x24
/* 80049594 000464F4  48 03 56 C1 */	bl OSSleepThread
lbl_80049598:
/* 80049598 000464F8  80 1F 00 1C */	lwz r0, 0x1c(r31)
/* 8004959C 000464FC  28 00 00 00 */	cmplwi r0, 0
/* 800495A0 00046500  40 82 FF F0 */	bne lbl_80049590
/* 800495A4 00046504  83 FF 00 20 */	lwz r31, 0x20(r31)
/* 800495A8 00046508  7F C3 F3 78 */	mr r3, r30
/* 800495AC 0004650C  48 03 16 A1 */	bl OSRestoreInterrupts
/* 800495B0 00046510  7F E3 FB 78 */	mr r3, r31
/* 800495B4 00046514  80 01 00 1C */	lwz r0, 0x1c(r1)
/* 800495B8 00046518  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 800495BC 0004651C  83 C1 00 10 */	lwz r30, 0x10(r1)
/* 800495C0 00046520  38 21 00 18 */	addi r1, r1, 0x18
/* 800495C4 00046524  7C 08 03 A6 */	mtlr r0
/* 800495C8 00046528  4E 80 00 20 */	blr 

.global TypeAndStatusCallback
TypeAndStatusCallback:
/* 800495CC 0004652C  7C 08 02 A6 */	mflr r0
/* 800495D0 00046530  90 01 00 04 */	stw r0, 4(r1)
/* 800495D4 00046534  94 21 FD 10 */	stwu r1, -0x2f0(r1)
/* 800495D8 00046538  93 E1 02 EC */	stw r31, 0x2ec(r1)
/* 800495DC 0004653C  3B E3 00 00 */	addi r31, r3, 0
/* 800495E0 00046540  3C 60 80 1F */	lis r3, __GBA@ha
/* 800495E4 00046544  93 C1 02 E8 */	stw r30, 0x2e8(r1)
/* 800495E8 00046548  57 E5 40 2E */	slwi r5, r31, 8
/* 800495EC 0004654C  93 A1 02 E4 */	stw r29, 0x2e4(r1)
/* 800495F0 00046550  80 0D 8A 30 */	lwz r0, __GBAReset-_SDA_BASE_(r13)
/* 800495F4 00046554  2C 00 00 00 */	cmpwi r0, 0
/* 800495F8 00046558  38 03 6D 80 */	addi r0, r3, __GBA@l
/* 800495FC 0004655C  7F C0 2A 14 */	add r30, r0, r5
/* 80049600 00046560  40 82 00 D4 */	bne lbl_800496D4
/* 80049604 00046564  54 80 06 3F */	clrlwi. r0, r4, 0x18
/* 80049608 00046568  40 82 00 14 */	bne lbl_8004961C
/* 8004960C 0004656C  54 83 00 1E */	rlwinm r3, r4, 0, 0, 0xf
/* 80049610 00046570  3C 03 FF FC */	addis r0, r3, 0xfffc
/* 80049614 00046574  28 00 00 00 */	cmplwi r0, 0
/* 80049618 00046578  41 82 00 10 */	beq lbl_80049628
lbl_8004961C:
/* 8004961C 0004657C  38 00 00 01 */	li r0, 1
/* 80049620 00046580  90 1E 00 20 */	stw r0, 0x20(r30)
/* 80049624 00046584  48 00 00 3C */	b lbl_80049660
lbl_80049628:
/* 80049628 00046588  3C 60 80 05 */	lis r3, __GBAHandler@ha
/* 8004962C 0004658C  80 BE 00 0C */	lwz r5, 0xc(r30)
/* 80049630 00046590  39 03 94 50 */	addi r8, r3, __GBAHandler@l
/* 80049634 00046594  80 FE 00 10 */	lwz r7, 0x10(r30)
/* 80049638 00046598  81 3E 00 30 */	lwz r9, 0x30(r30)
/* 8004963C 0004659C  7F E3 FB 78 */	mr r3, r31
/* 80049640 000465A0  81 5E 00 34 */	lwz r10, 0x34(r30)
/* 80049644 000465A4  38 9E 00 00 */	addi r4, r30, 0
/* 80049648 000465A8  38 DE 00 05 */	addi r6, r30, 5
/* 8004964C 000465AC  48 03 93 65 */	bl SITransfer
/* 80049650 000465B0  2C 03 00 00 */	cmpwi r3, 0
/* 80049654 000465B4  40 82 00 80 */	bne lbl_800496D4
/* 80049658 000465B8  38 00 00 02 */	li r0, 2
/* 8004965C 000465BC  90 1E 00 20 */	stw r0, 0x20(r30)
lbl_80049660:
/* 80049660 000465C0  81 9E 00 38 */	lwz r12, 0x38(r30)
/* 80049664 000465C4  28 0C 00 00 */	cmplwi r12, 0
/* 80049668 000465C8  41 82 00 18 */	beq lbl_80049680
/* 8004966C 000465CC  38 00 00 00 */	li r0, 0
/* 80049670 000465D0  7D 88 03 A6 */	mtlr r12
/* 80049674 000465D4  90 1E 00 38 */	stw r0, 0x38(r30)
/* 80049678 000465D8  7F E3 FB 78 */	mr r3, r31
/* 8004967C 000465DC  4E 80 00 21 */	blrl 
lbl_80049680:
/* 80049680 000465E0  80 1E 00 1C */	lwz r0, 0x1c(r30)
/* 80049684 000465E4  28 00 00 00 */	cmplwi r0, 0
/* 80049688 000465E8  41 82 00 4C */	beq lbl_800496D4
/* 8004968C 000465EC  48 03 0C 39 */	bl OSGetCurrentContext
/* 80049690 000465F0  3B A3 00 00 */	addi r29, r3, 0
/* 80049694 000465F4  38 61 00 10 */	addi r3, r1, 0x10
/* 80049698 000465F8  48 03 0D 99 */	bl OSClearContext
/* 8004969C 000465FC  38 61 00 10 */	addi r3, r1, 0x10
/* 800496A0 00046600  48 03 0B C9 */	bl OSSetCurrentContext
/* 800496A4 00046604  81 9E 00 1C */	lwz r12, 0x1c(r30)
/* 800496A8 00046608  38 00 00 00 */	li r0, 0
/* 800496AC 0004660C  38 7F 00 00 */	addi r3, r31, 0
/* 800496B0 00046610  90 1E 00 1C */	stw r0, 0x1c(r30)
/* 800496B4 00046614  7D 88 03 A6 */	mtlr r12
/* 800496B8 00046618  80 9E 00 20 */	lwz r4, 0x20(r30)
/* 800496BC 0004661C  4E 80 00 21 */	blrl 
/* 800496C0 00046620  38 61 00 10 */	addi r3, r1, 0x10
/* 800496C4 00046624  48 03 0D 6D */	bl OSClearContext
/* 800496C8 00046628  7F A3 EB 78 */	mr r3, r29
/* 800496CC 0004662C  48 03 0B 9D */	bl OSSetCurrentContext
/* 800496D0 00046630  48 03 4B 81 */	bl __OSReschedule
lbl_800496D4:
/* 800496D4 00046634  80 01 02 F4 */	lwz r0, 0x2f4(r1)
/* 800496D8 00046638  83 E1 02 EC */	lwz r31, 0x2ec(r1)
/* 800496DC 0004663C  83 C1 02 E8 */	lwz r30, 0x2e8(r1)
/* 800496E0 00046640  83 A1 02 E4 */	lwz r29, 0x2e4(r1)
/* 800496E4 00046644  38 21 02 F0 */	addi r1, r1, 0x2f0
/* 800496E8 00046648  7C 08 03 A6 */	mtlr r0
/* 800496EC 0004664C  4E 80 00 20 */	blr 

.global __GBATransfer
__GBATransfer:
/* 800496F0 00046650  7C 08 02 A6 */	mflr r0
/* 800496F4 00046654  90 01 00 04 */	stw r0, 4(r1)
/* 800496F8 00046658  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 800496FC 0004665C  BF 61 00 1C */	stmw r27, 0x1c(r1)
/* 80049700 00046660  3B 63 00 00 */	addi r27, r3, 0
/* 80049704 00046664  3C 60 80 1F */	lis r3, __GBA@ha
/* 80049708 00046668  57 67 40 2E */	slwi r7, r27, 8
/* 8004970C 0004666C  38 03 6D 80 */	addi r0, r3, __GBA@l
/* 80049710 00046670  3B 84 00 00 */	addi r28, r4, 0
/* 80049714 00046674  3B A5 00 00 */	addi r29, r5, 0
/* 80049718 00046678  3B E6 00 00 */	addi r31, r6, 0
/* 8004971C 0004667C  7F C0 3A 14 */	add r30, r0, r7
/* 80049720 00046680  48 03 15 05 */	bl OSDisableInterrupts
/* 80049724 00046684  93 FE 00 38 */	stw r31, 0x38(r30)
/* 80049728 00046688  3C 80 80 05 */	lis r4, TypeAndStatusCallback@ha
/* 8004972C 0004668C  3B E3 00 00 */	addi r31, r3, 0
/* 80049730 00046690  93 9E 00 0C */	stw r28, 0xc(r30)
/* 80049734 00046694  38 84 95 CC */	addi r4, r4, TypeAndStatusCallback@l
/* 80049738 00046698  7F 63 DB 78 */	mr r3, r27
/* 8004973C 0004669C  93 BE 00 10 */	stw r29, 0x10(r30)
/* 80049740 000466A0  48 03 98 39 */	bl SIGetTypeAsync
/* 80049744 000466A4  7F E3 FB 78 */	mr r3, r31
/* 80049748 000466A8  48 03 15 05 */	bl OSRestoreInterrupts
/* 8004974C 000466AC  BB 61 00 1C */	lmw r27, 0x1c(r1)
/* 80049750 000466B0  38 60 00 00 */	li r3, 0
/* 80049754 000466B4  80 01 00 34 */	lwz r0, 0x34(r1)
/* 80049758 000466B8  38 21 00 30 */	addi r1, r1, 0x30
/* 8004975C 000466BC  7C 08 03 A6 */	mtlr r0
/* 80049760 000466C0  4E 80 00 20 */	blr 

.global __GBASetDelay
__GBASetDelay:
/* 80049764 000466C4  3C 80 80 1F */	lis r4, __GBA@ha
/* 80049768 000466C8  54 63 40 2E */	slwi r3, r3, 8
/* 8004976C 000466CC  38 04 6D 80 */	addi r0, r4, __GBA@l
/* 80049770 000466D0  7C E0 1A 14 */	add r7, r0, r3
/* 80049774 000466D4  80 67 00 30 */	lwz r3, 0x30(r7)
/* 80049778 000466D8  80 87 00 34 */	lwz r4, 0x34(r7)
/* 8004977C 000466DC  90 C7 00 34 */	stw r6, 0x34(r7)
/* 80049780 000466E0  90 A7 00 30 */	stw r5, 0x30(r7)
/* 80049784 000466E4  4E 80 00 20 */	blr 
